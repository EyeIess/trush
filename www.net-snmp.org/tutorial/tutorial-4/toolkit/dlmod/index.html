
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  
<!-- Mirrored from www.net-snmp.org/tutorial/tutorial-4/toolkit/dlmod/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 19:17:03 GMT -->
<head>
    <title>Net-SNMP</title>

    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta http-equiv="Content-Language" content="en-us" />

    
    <meta name="description" content="Net-SNMP" />

    <meta name="author" content="Alex Burger" />

    <meta name="Rating" content="General" />

    <meta name="Keywords" content="net-snmp,ucd-snmp,netsnmp,ucdsnmp,snmp,snmp trap,trap,trap receiver,alert,network alert,network trouble,network downtime,snmp.conf,snmpd.conf,snmptrapd.conf,agentx.conf" />
    <link rel="StyleSheet" type="text/css" href="../../../../layout1.css" />
    <link rel="StyleSheet" media="print,projection" type="text/css" href="../../../../print1.css" />
  </head>
  <body background="../../../../images/net-snmp-bg2.jpg">
   
    <div id="Header">
      <!-- slogan -->
      <div class="HeaderSmall" align="right"><br /><br /><i>Current release: 5.9.2</i></div>
    </div>

    <div id="HeaderMap">
      <map name="logo" id="logo">
        <area alt="Logo" shape="rect" coords="0,0,2000,40" href="../../../../logo.html" title="Click here for details about the original Net-SNMP / UCD-SNMP logo"></area>
      </map>
      <img align="left" vspace="0" hspace="0" width="100%" height="40" border="0" src="../../../../images/blank3.gif" alt="Logo" usemap="#logo"/> <br />
    </div>

    <div id="Header2">
      <map name="homepage" id="homepage">
        <area alt="Home page" shape="rect" coords="0,0,130,30" href="../../../../index.html"></area>
      </map>
      <img align="left" vspace="0" hspace="0" width="130" height="30" border="0" src="../../../../images/logos/logo1_65_tr_small.gif" alt="Net-SNMP" usemap="#homepage"/> <br />
    </div>

    
    <div id="LeftSide">
      <div id="skip"><a href="#Content">skip to page content</a><br /><br /></div>
      <div id="Menu">

        <!-- <a href="/" >Home</a><br /> -->

        <a href="../../../../index.html">About</a><br />
        

        <a href="../../../../download.html" title="Download Net-SNMP binaries and source code">Download</a><br />

        <a href="../../../../wiki/index.php/Tutorials.html" >Tutorials</a><br />
        
        <div id = "MenuSub">
          <table>
            <tr><td>&nbsp;&middot;</td><td><a href="../../../tutorial-5/index.html"
                  title="Net-SNMP v5 tutorial">Version 5.x</a></td></tr>
            <tr><td>&nbsp;&middot;</td><td><a href="../../index.html"
                  title="UCD-SNMP v4 tutorial">Version 4.x</a></td></tr>
          </table>
        </div>
        

        <a href="../../../../docs/readmefiles.html">Documentation</a><br />
        

        <a href="../../../../wiki/index.html" title="Net-SNMP Wiki">Wiki</a><br />

        <a href="../../../../support/contacts.html" >Support</a><br />
        

        <a href="../../../../dev/projects.html">Development</a><br />
        

        <a href="../../../../related.html" title="Links to Net-SNMP related information and software">Related Info/SW</a><br />

        <br />
      </div>
      <br />

      <div id="ListSearch">
          <form method="post" action="http://sourceforge.net/search/">
          <span class="small">Archive Search:</span>
       
          <select name="forum_id">
            <option value="4959">Users</option>
            <option value="7152">Coders</option>
            <option value="12455">Announce</option>
            <option value="7153">Bugs</option>
            <option value="7151">Patches</option>
            <option value="33108">SVN (named "CVS")</option>
          </select>
       
          <input type="hidden" name="type_of_search" value="mlists" />
          <input type="hidden" name="group_id" value="12694" />
          <input type="text" name="words" size=15 id="Words" value="" /><br />
          <input type="submit" name="Search" value="Search" /><br />
          <input type="checkbox" name="exact" value="1" checked />
          <span id="Label">Require all words?</span>   
        </form>
      </div>
      <br />

      <div id="SiteSearch">
          <form method=GET action="http://www.google.com/search">
          <span class="small">Site Search:</span>
          
          <input type=hidden name=ie value=UTF-8>
          <input type=hidden name=oe value=UTF-8>
          <input type="text" name=q size=15 maxlength=255 value="" /><br />
          <input type=hidden name=sitesearch value="www.net-snmp.org">
          <input type=submit name=btnG VALUE="Google Search">
          <a href="http://www.google.com/">
            <img src="../../../../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="absmiddle"></A>

        </form>
      </div>


      
      <div id="MenuSFLogo">
        <a href="http://www.sourceforge.net/projects/net-snmp" target="sourceforge" title="Net-SNMP SourceForge project page"> <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=12694&amp;type=2" width="125" height="37" border="0" alt="SourceForge.net Net-SNMP Project" /></a>
        
      </div>
  </div>
    
  <div id="Content">


<!-- CONTENT START -->
    <p>
      <b>Note:</b>  Much of this tutorial requires <a
	href="http://prdownloads.sourceforge.net/net-snmp/ucd-snmp-4.2.6.tar.gz">ucd-snmp-4.2.2 or higher</a>!,
	so make sure you get it before running the commands found in
	this tutorial.</b> 
      <p><b>Note:</b>  A new tutorial for net-snmp 5.0 and above <a
      href="../../../../tutorial-5/index.html">is available</a> as well.  The commands is
      the ucd-snmp specific tutorial will not work as expected if you
      are using net-snmp and not ucd-snmp.
      <br><br>
    <hr>
    <h1>Dynamic Module Creation for the ucd-snmp agent</h1>
    <p>
      Now, lets take the ustScalarSet mib module we created in the <a
      href="../mib_module/index.html">previous example</a> and make it work as a
      dynamicly loadable shared object.

    <p><b>Note:</b> For this to work, you must have compiled the
      ucd-snmp package with dynamicly loadable module support turned
      on, as well as built it with --enable-shared turned on .  It's
      on by default, if your system supports it, in version 4.2 and
      higher.  You can check your agent but looking at the output of
      the "snmpd -H" command for the "dlmod" token.  If its listed,
      the compiled agent supports it.

    <p><b>Note:</b> You should also re-compile
      the agent <b>without</b> the ustScalarSet code by removing it
      from the list of --with-mib-modules option, or else this example
      won't work correctly.

    <p><b>Note:</b> All command line options below assume you have an
    appropriately setup ~/.snmp/snmp.conf file that allows you to not
    have to specify a snmp version number, community name, username,
    or whatever else in order to talk to your agent.  The agent, of
    course, must have a matching /usr/local/share/snmp/snmpd.conf file 
    (or equivalent).

    <p>
      Here are the files discussed in this example so you can download
      them:
      <center>
      <table border=1>
	<tr bgcolor="#d0d0ff"><th>File</th><th>Description</th></tr>
	<tr bgcolor="#d0d0ff"><td><a
	href="../demoapp/Makefile">Makefile</a></td><td>A simple makefile 
	used to build the projects</td>
	<tr bgcolor="#d0d0ff"><td><a
	href="../mib_module/UCD-SNMP-TUTORIAL-MIB.txt">UCD-SNMP-TUTORIAL-MIB.txt</a></td><td>The MIB we'll be writing
	code for</td>
	<tr bgcolor="#d0d0ff"><td><a
	href="../mib_module/ustScalarSet.h">ustScalarSet.h</a></td><td>The mib module's header file</td>
	<tr bgcolor="#d0d0ff"><td><a
	href="../mib_module/ustScalarSet.c">ustScalarSet.c</a></td><td>The mib module's C source code</td>
      </table>
      </center>
      <hr>
    <p>
      The shared object loader calls the "init_ustScalarSet()"
      function when the module gets loaded, and calls the
      "deinit_ustScalarSet()" when (and if) the module is unloaded.
      These function names to use are built by adding the shared
      object's module name (UCD-DLMOD-MIB::dlmodName) to the `init_'
      and `deinit_' prefixes.
      <p>
      Steps to build the shared object:
      <ol>
	<li>First off we must get the 
<a href="../demoapp/Makefile">Makefile</a> file, the <a
href="../mib_module/ustScalarSet.h">ustScalarSet.h</a> file, and the <a
href="../mib_module/ustScalarSet.c">ustScalarSet.c</a> file.
	<li><b>make ustScalarSet.so</b>
    </ol>
    <p>
      Steps to test the shared object:
      <ol>
      <li> Start the snmpd and watch the dlmod and ustScalarSet
      modules interact using the debugging flag (this assumes you
      already have <a
      href="../../../../FAQ.html#I_don_t_understand_the_new_access_control_stuff___what_does_it_mean_">access control</a> set up properly for your agent):
	<p><ul>
	  <li> % <b>snmpd -f -L -DustScalarSet,dlmod </b>
	</ul><p>
      <li> In another window, test to make sure that the agent doesn't 
      currently support the ustScalarSet (if you get different results 
      running this command you need to recompile the ucd-snmp agent
      without the ustScalarSet mib module compiled in directly):
	<p><ul>
	  <li> % <b>snmpget  localhost UCD-SNMP-TUTORIAL-MIB::ustSSSimpleString.0 </b>
	<p><pre>
ustSSSimpleString.0 = No Such Object available on this agent
	    </pre>	</ul><p>

      <li> Then, run snmpset to create a new row in the dlmod table:
	<p><ul>
	  <li> % <b>snmpset  localhost UCD-DLMOD-MIB::dlmodStatus.1 i create </b>
<p><pre>
dlmodStatus.1 = create(6)
</pre>
	<p></ul>
      <li> See that the row was created:
	<p><ul>
	    <li> % <b>snmptable  localhost UCD-DLMOD-MIB::dlmodTable </b>
<p><pre>
SNMP table: dlmodTable

 dlmodName dlmodPath dlmodError dlmodStatus
                                   unloaded
</pre><p>
	</ul>
      <li> Then set the properties of the row up to point to our new
      object and to give it a name:
	<p><ul>
	  <li> % <b>snmpset localhost UCD-DLMOD-MIB::dlmodName.1 s "ustScalarSet" UCD-DLMOD-MIB::dlmodPath.1 s "/path/to/ustScalarSet.so" </b>
<p><pre>
dlmodName.1 = "ustScalarSet" 
dlmodName.1 = "/path/to/ustScalarSet.so"
</pre>
	  <li> % <b>snmptable  localhost UCD-DLMOD-MIB::dlmodTable </b>
<p><pre>
SNMP table: dlmodTable

    dlmodName dlmodPath                 dlmodError   dlmodStatus
 ustScalarSet /path/to/ustScalarSet.so                  unloaded
</pre><p>
	</ul>
	<li> Finally, load the shared object into the running agent:
	<p><ul>
	  <li> % <b>snmpset  localhost UCD-DLMOD-MIB::dlmodStatus.1 i load </b>
<p><pre>
dlmodName.1 = ustScalarSet
dlmodName.1 = /path/to/ustScalarSet.so
</pre>
	  <li> % <b>snmptable  localhost UCD-DLMOD-MIB::dlmodTable </b>
<p><pre>
SNMP table: dlmodTable

    dlmodName                      dlmodPath dlmodError dlmodStatus
 ustScalarSet /path/to/ustScalarSet.so                 loaded
</pre><p>
	</ul>
      <li> If everything above was done correctly, then the following
	command should work and will access the shared object's data:
	<p><ul><li> % <b>snmpget  localhost UCD-SNMP-TUTORIAL-MIB::ustSSSimpleString.0 </b>
<p><pre>
ustSSSimpleString.0 = "Hello World"
</pre><p>
	</ul>
    </ol>
    <hr>
    <p> You can also load shared objects using the "dlmod" token in the
    snmpd.conf file by putting a line like this in your snmpd.conf file:
<p><pre>
      dlmod ustScalarSet /path/to/ustScalarSet.so
    </pre>  
    <p>The first argument specifies the shared object's module name
      (UCD-DLMOD-MIB::dlmodName) and second argument specifies the
      full pathname of the shared object file.
<!-- CONTENT END -->
<br />
<div id="w3Valid" class="w3Valid">
<p>
<!-- 
<a href="http://validator.w3.org/check/referer">
  <img src="/images/valid-xhtml10.png" style="border:0"
  alt="Valid XHTML 1.0!" height="31" width="88"/></a>
-->
<a href="../../../../../jigsaw.w3.org/css-validator/validator6472.html?uri=http://www.net-snmp.org/layout1.css">
  <img style="border:0;width:88px;height:31px"
  src="../../../../images/vcss.png" 
       alt="Valid CSS!" />
 </a>
</p>
</div> <!-- w3Valid /div -->
</div> <!-- CONTENT END /div -->

<div id="ModificationDate" class="ModificationDate">
  <hr />

<!-- MODIFICATION DATE START -->

<p>Last modified: Wednesday, 01-Aug-2018 04:41:28 UTC<br/>
For questions regarding web content and site functionality, please write to the <a href="mailto:net-snmp-users@lists.sourceforge.net">net-snmp-users mail list</a>.</p>

<!-- MODIFICATION DATE END -->

</div>

</body>


<!-- Mirrored from www.net-snmp.org/tutorial/tutorial-4/toolkit/dlmod/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 19:17:04 GMT -->
</html>



