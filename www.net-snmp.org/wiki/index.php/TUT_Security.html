

<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from www.net-snmp.org/wiki/index.php/TUT:Security by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 17:56:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>TUT:Security - Net-SNMP Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"TUT:Security","wgTitle":"TUT:Security","wgCurRevisionId":5653,"wgRevisionId":5653,"wgArticleId":2085,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"TUT:Security","wgRelevantArticleId":2085,"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits"]);
} );</script>
<link rel="stylesheet" href="../load34a1.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook" />
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="../load3a95.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.26.3" />
<link rel="shortcut icon" href="../../favicon.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="Net-SNMP Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="../api251f.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Net-SNMP Wiki Atom feed" href="../apidf90.php?title=Special:RecentChanges&amp;feed=atom" />
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-TUT_Security skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">TUT:Security</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Net-SNMP Wiki</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#SNMPv1_and_SNMPv2c:_Insecure.21.21.21"><span class="tocnumber">1</span> <span class="toctext">SNMPv1 and SNMPv2c: Insecure!!!</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#SNMPv3:_Making_it_secure"><span class="tocnumber">2</span> <span class="toctext">SNMPv3: Making it secure</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Using_Secure_SNMP"><span class="tocnumber">2.1</span> <span class="toctext">Using Secure SNMP</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Ok.2C_but_what_should_I_pick.3F"><span class="tocnumber">2.2</span> <span class="toctext">Ok, but what should I pick?</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#SNMPv3_with_USM"><span class="tocnumber">3</span> <span class="toctext">SNMPv3 with USM</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Tunneling_SNMPv3"><span class="tocnumber">4</span> <span class="toctext">Tunneling SNMPv3</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Kerberos_SNMPv3"><span class="tocnumber">5</span> <span class="toctext">Kerberos SNMPv3</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="SNMPv1_and_SNMPv2c:_Insecure.21.21.21">SNMPv1 and SNMPv2c: Insecure!!!</span></h2>
<p>SNMP, when it was first developed, contained clear-text-"passwords" called "community strings".  The first two versions of the SNMP protocol (SNMPv1 and SNMPv2c) contained these clear text passwords, as can be seen below in the following screen dump:
</p>
<pre># <b>snmpget -d -v 2c -c <font color="red">demopublic</font> test.net-snmp.org sysContact.0</b>

Sending 47 bytes to UDP: [157.185.82.8]:161-&gt;[0.0.0.0]:0
0000: 30 2D 02 01  01 04 0A 64  65 6D 6F 70  75 62 6C 69    0-.....<font color="red">demopubli</font>
0016: 63 A0 1C 02  04 78 8E 32  C9 02 01 00  02 01 00 30    <font color="red">c</font>....x.2.......0
0032: 0E 30 0C 06  08 2B 06 01  02 01 01 04  00 05 00       .0...+.........
  

Received 102 byte packet from UDP: [157.185.82.8]:161-&gt;[0.0.0.0]:47960
0000: 30 64 02 01  01 04 0A 64  65 6D 6F 70  75 62 6C 69    0d.....<font color="red">demopubli</font>
0016: 63 A2 53 02  04 78 8E 32  C9 02 01 00  02 01 00 30    <font color="red">c</font>.S..x.2.......0
0032: 45 30 43 06  08 2B 06 01  02 01 01 04  00 04 37 4E    E0C..+........7N
0048: 65 74 2D 53  4E 4D 50 20  43 6F 64 65  72 73 20 3C    et-SNMP Coders &lt;
0064: 6E 65 74 2D  73 6E 6D 70  2D 63 6F 64  65 72 73 40    net-snmp-coders@
0080: 6C 69 73 74  73 2E 73 6F  75 72 63 65  66 6F 72 67    lists.sourceforg
0096: 65 2E 6E 65  74 3E                                    e.net&gt;

SNMPv2-MIB::sysContact.0 = STRING: Net-SNMP Coders &lt;net-snmp-coders@lists.sourceforge.net&gt;
</pre>
<p>This was obviously a problem so SNMPv3 was later developed to secure the protocol.
</p>
<h2><span class="mw-headline" id="SNMPv3:_Making_it_secure">SNMPv3: Making it secure</span></h2>
<p>SNMPv3, documented in RFCS 3410-3419, defines a modular approach to SNMPv3.  This modular approach is important as it is designed to allow the protocol to adapt in the future if other types of security will be needed or preferred.
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="File_Snmpv3arch.html" class="image"><img alt="" src="../images/thumb/7/7e/Snmpv3arch.jpeg/600px-Snmpv3arch.jpg" width="600" height="367" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="File_Snmpv3arch.html" class="internal" title="Enlarge"></a></div>SNMPv3 architecture</div></div></div>
<h3><span class="mw-headline" id="Using_Secure_SNMP">Using Secure SNMP</span></h3>
<p>Choices for securing SNMP include, which are described in detail below:
</p>
<table border="1" cellspacing="0" style="border-style: solid; border-width: 1px; margin-left: 2em;">

<tr>
<td> SNMPv1 or SNMPv2c
</td>
<td> Provides <b>NO SECURITY</b> at all.  Supported by everything.
</td></tr>
<tr>
<td> SNMPv3 with USM
</td>
<td> The original SNMPv3 security model.  Supported by most devices.
</td></tr>
<tr>
<td> SNMPv3 with <a href="TLS.html" title="TLS">TLS</a> or <a href="DTLS.html" title="DTLS">DTLS</a>
</td>
<td> Tunneling SNMP over TLS and DTLS.  Hopefully supported by most devices soon.
</td></tr>
<tr>
<td> SNMPv3 over <a href="SSH.html" title="SSH">SSH</a>
</td>
<td> Tunneling SNMP over SSH (not 100% supported in Net-SNMP)
</td></tr>
<tr>
<td> SNMP over <a href="Kerberos.html?title=Kerberos&amp;action=edit&amp;redlink=1" class="new" title="Kerberos (page does not exist)">Kerberos</a>
</td>
<td> Securing SNMP with Kerberos (even less supported)
</td></tr></table>
<h3><span class="mw-headline" id="Ok.2C_but_what_should_I_pick.3F">Ok, but what should I pick?</span></h3>
<p>Pick the best one for your situation of course!  Some helpful starting hints though:
</p>
<ul><li> If entirely using Net-SNMP products, or products that support TLS: use <a href="Using_DTLS.html" title="Using DTLS">SNMPv3 over (D)TLS</a></li>
<li> If talking to legacy SNMPv3 devices: use <a href="TUT_SNMPv3_Options.html" title="TUT:SNMPv3 Options">SNMPv3/USM</a></li>
<li> If talking to SNMPv1/SNMPv2c only devices: call the vendor and complain!  Seriously.</li></ul>
<h2><span class="mw-headline" id="SNMPv3_with_USM">SNMPv3 with USM</span></h2>
<p>The original SNMPv3 specifications included a <i>User-Based Security Model</i> which secured the protocol by allowing administrators to define "users" with various security credentials.  This went a long way toward securing the protocol (although, as Wes Hardaker (the founder of Net-SNMP) <a rel="nofollow" class="external text" href="http://pontifications.hardakers.net/computers/limitations-of-snmpv3usm-when-combined-with-engineid-discovery/">documents on a blog entry</a>, there are still some concerns with SNMPv3/USM).  Operators also found that securing SNMPv3/USM required "yet another" password database to maintain which was operationally burdensome.
</p><p>SNMPv3/USM is fairly widely implemented and most modern "good" devices will support it.
</p><p>See our <a href="TUT_SNMPv3_Options.html" title="TUT:SNMPv3 Options">SNMPv3/USM tutorial</a> for details on using SNMPv3/USM with the Net-SNMP toolkit.
</p>
<h2><span class="mw-headline" id="Tunneling_SNMPv3">Tunneling SNMPv3</span></h2>
<p>The most recent IETF activity regarding SNMP security has been done in the <a rel="nofollow" class="external text" href="http://tools.ietf.org/wg/isms/">Integrated Security Model for SNMP (ISMS)</a> working group.  Rather than create another security system like USM did, it was decided that users would prefer to tunnel SNMP over protocols they already knew and understood.  This was done by creating the following new RFCs:
</p>
<ul><li> <a href="http://www.rfc-editor.org/rfc/rfc5590.txt" class="extiw" title="rfc:5590">RFC5590</a> - Transport Subsystem for the Simple Network Management Protocol</li>
<li> <a href="http://www.rfc-editor.org/rfc/rfc5591.txt" class="extiw" title="rfc:5591">RFC5591</a> - Transport Security Model for the Simple Network Management Protocol (SNMP)</li>
<li> <a href="http://www.rfc-editor.org/rfc/rfc5592.txt" class="extiw" title="rfc:5592">RFC5592</a> - Secure Shell Transport Model for the Simple Network Management Protocol (SNMP)</li>
<li> <a href="http://www.rfc-editor.org/rfc/rfc5608.txt" class="extiw" title="rfc:5608">RFC5608</a> - Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models.</li>
<li> <a href="http://www.rfc-editor.org/rfc/rfc5953.txt" class="extiw" title="rfc:5953">RFC5953</a> - Transport Layer Security (TLS) Transport Model for the Simple Network Management Protocol (SNMP)</li></ul>
<p>These RFCs provide the framework for tunneling SNMPv3 packets over <a href="SSH.html" title="SSH">SSH</a>, <a href="TLS.html" title="TLS">TLS</a> and <a href="DTLS.html" title="DTLS">DTLS</a>.  The SSH protocol uses existing SSH authentication and encryption methods (like SSH keys and/or usernames and passwords) to secure it's traffic.  And the TLS and DTLS protocols use X.509 certificates for securing it's traffic.
</p><p>Net-SNMP 5.6 contains robust support for using SNMP over TLS and DTLS.
</p><p>See the <a href="TUT_Using_TLS.html" title="TUT:Using TLS">Using TLS tutorial</a> for details on seting up and using SNMP over TLS and DTLS.
</p><p>Net-SNMP 5.6 also contains minimal support for using SNMP over SSH, but the support is limited because of the lack of available SSH server-side libraries and is implemented through a specialized shell "hack" when attached to a OpenSSH sshd server.
</p><p>There is information about the performance impacts of using SSH available <a rel="nofollow" class="external text" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.109.8294&amp;rep=rep1&amp;type=pdf">here</a> (also available as slides from an IETF presentation <a rel="nofollow" class="external text" href="http://www.ietf.org/proceedings/67/slides/isms-3.pdf">here</a>).
</p>
<h2><span class="mw-headline" id="Kerberos_SNMPv3">Kerberos SNMPv3</span></h2>
<p>Wes Hardaker and Ken Horstein started work in the IETF to implement a kerberos security model for SNMPv3.  Although Net-SNMP contains a prototype implementation of this, the work was never finished within the IETF nor within the Net-SNMP implementation and is not yet ready for real-world use.
</p>
<!-- 
NewPP limit report
Cached time: 20171116023325
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.227 seconds
Real time usage: 0.314 seconds
Preprocessor visited node count: 31/1000000
Preprocessor generated node count: 42/1000000
Postâ€expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key n12694_wikidb:pcache:idhash:2085-0!*!0!!en!5!* and timestamp 20171116023325 and revision id 5653
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="../indexd6d4.html?title=TUT:Security&amp;oldid=5653">http://www.net-snmp.org/wiki/index.php?title=TUT:Security&amp;oldid=5653</a>"</div>
					<div id='catlinks' class='catlinks catlinks-allhidden'></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="TUT_Security.html" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="Talk_TUT_Security.html?title=Talk:TUT:Security&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="../index6c02.html?title=TUT:Security&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="../index3bfe.html?title=TUT:Security&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="../index4fb0.html?title=Special:UserLogin&amp;returnto=TUT%3ASecurity&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="../indexe516.html?title=Special:UserLogin&amp;returnto=TUT%3ASecurity" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="Main_Page.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-project" role="navigation">
		<h3>project</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Web-Site"><a href="../../index.html" rel="nofollow">Web Site</a></li>
											<li id="n-Wiki"><a href="Main_Page.html">Wiki</a></li>
											<li id="n-Download"><a href="../../download.html" rel="nofollow">download</a></li>
											<li id="n-Mailing-Lists"><a href="../../support/mailinglists.html" rel="nofollow">Mailing Lists</a></li>
											<li id="n-Bug-Reports"><a href="../../support/bugreports.html" rel="nofollow">Bug Reports</a></li>
											<li id="n-Patches"><a href="../../support/patches.html" rel="nofollow">Patches</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-documentation" role="navigation">
		<h3>documentation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Tutorials"><a href="Tutorials.html">Tutorials</a></li>
											<li id="n-FAQ"><a href="FAQ.html">FAQ</a></li>
											<li id="n-Good-Answers"><a href="Category_GoodAnswer.html">Good Answers</a></li>
											<li id="n-Manual-Pages"><a href="../../man/index.html" rel="nofollow">Manual Pages</a></li>
											<li id="n-Tools"><a href="Category_Tools.html">Tools</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-wiki" role="navigation">
		<h3>wiki</h3>
		<div class='pBody'>
							<ul>
											<li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="Notes20111219.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://www.net-snmp.org/wiki/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Net-SNMP Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/TUT_Security.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/TUT_Security.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="../index9a40.html?title=TUT:Security&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="../indexd6d4.html?title=TUT:Security&amp;oldid=5653" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="../index27d1.html?title=TUT:Security&amp;action=info" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="../resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified on 21 January 2013, at 14:26.</li>
									<li id="privacy"><a href="Net-SNMP_Wiki_Privacy_policy.html" title="Net-SNMP Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Net-SNMP_Wiki_About.html" title="Net-SNMP Wiki:About">About Net-SNMP Wiki</a></li>
									<li id="disclaimer"><a href="Net-SNMP_Wiki_General_disclaimer.html" title="Net-SNMP Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"]);
} );</script><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":1322});
} );</script></body><!-- Cached 20171116023326 -->

<!-- Mirrored from www.net-snmp.org/wiki/index.php/TUT:Security by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 17:56:17 GMT -->
</html>
