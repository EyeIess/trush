

<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from www.net-snmp.org/wiki/index.php?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 18:28:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Using the command line and nmake (VC++ 2010 Express) - Net-SNMP Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Using_the_command_line_and_nmake_(VC++_2010_Express)","wgTitle":"Using the command line and nmake (VC++ 2010 Express)","wgCurRevisionId":5849,"wgRevisionId":5849,"wgArticleId":2428,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Using_the_command_line_and_nmake_(VC++_2010_Express)","wgRelevantArticleId":2428,"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits"]);
} );</script>
<link rel="stylesheet" href="load531d.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;printable=1&amp;skin=monobook" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="loadf198.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.26.3" />
<meta name="robots" content="noindex,follow" />
<link rel="shortcut icon" href="../favicon.html" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Net-SNMP Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api251f.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Net-SNMP Wiki Atom feed" href="apidf90.php?title=Special:RecentChanges&amp;feed=atom" />
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Using_the_command_line_and_nmake_VC_2010_Express skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Using the command line and nmake (VC++ 2010 Express)</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Net-SNMP Wiki</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p><b>Setup the build system</b>
</p>
<ul><li>Download and install Microsoft Visual C++ 2008 Express <a rel="nofollow" class="external autonumber" href="http://go.microsoft.com/fwlink/?LinkId=104679">[1]</a></li>
<li>Download and install Microsoft Visual C++ 2010 Express <a rel="nofollow" class="external autonumber" href="http://www.visualstudio.com/downloads/download-visual-studio-vs#DownloadFamilies_4">[2]</a></li>
<li>Download and install Windows SDK v7.1 <a rel="nofollow" class="external autonumber" href="http://www.microsoft.com/en-us/download/details.aspx?id=8279">[3]</a></li>
<li>Download and install ActivePerl v.5.16.3.1604 (<i><b>x64</b></i>) for the Make scripts and/or Perl Net-SNMP modules <a rel="nofollow" class="external autonumber" href="http://www.activestate.com/activeperl/downloads">[4]</a> <br /> <i><b>Restart Windows!</b></i></li>
<li>Download <b>Win64</b> OpenSSL v1.0.1j (<i><b>full</b></i>), install to C:\OpenSSL <a rel="nofollow" class="external autonumber" href="http://slproweb.com/products/Win32OpenSSL.html">[5]</a><br />Probably best to choose "The Windows system directory" during install, when prompted for the location to copy OpenSSL DLLs.  Unless you want to modify PATH environment variables and you know what you're doing. </li>
<li>Download Net-SNMP v5.7.2.1 ZIP <a rel="nofollow" class="external autonumber" href="http://sourceforge.net/projects/net-snmp/files/net-snmp/5.7.2.1/">[6]</a>, <i><b>extract to path without spaces</b></i> (e.g. C:\projects\net-snmp-5.7.2.1)</li></ul>
<p><b>Visual C++ 2010 Express cannot open/convert Visual C++ 6.0 projects.</b>
</p><p>Use Visual C++ 2008 Express to open C:\projects\net-snmp-5.7.2.1\win32\win32.dsw and convert the Solution and corresponding Projects to a recent Visual Studio version.  Afterwards, you can open the resulting Solution with VC++ 2010 Express.
<br /><br />
Edit .\snmplib\read_config.c, move line 545 to line 539.
</p><p>Microsoft Visual C++ does not follow the C99 code standard and therefore does not permit variable declaration in the middle of a code block.
</p><p><br />
Before:
</p>
<pre>538: if (when == EITHER_CONFIG || lptr-&gt;config_time == when) {
539:            DEBUGMSGTL(("read_config:parser",
540:                        "Found a parser.  Calling it:&#160;%s /&#160;%s\n", token,
541:                        cptr));
542:            /*
543:             * Make sure cptr is non-null
544:             */
545:            char tmpbuf[1];
546:            if (!cptr) {
547:                tmpbuf[0] = '\0';
548:                cptr = tmpbuf;
549:            }
</pre>
<p>After:
</p>
<pre>538: if (when == EITHER_CONFIG || lptr-&gt;config_time == when) {
539:            char tmpbuf[1];
540:            DEBUGMSGTL(("read_config:parser",
541:                        "Found a parser.  Calling it:&#160;%s /&#160;%s\n", token,
542:                        cptr));
543:            /*
544:             * Make sure cptr is non-null
545:             */
546:            if (!cptr) {
547:                tmpbuf[0] = '\0';
548:                cptr = tmpbuf;
549:            }
</pre>
<p><b>Build Net-SNMP</b>
</p><p>Open a command prompt with the correct options:
</p>
<ul><li>cmd /V:ON /E:ON</li></ul>
<p>Set the environment variables for Visual Studio as well as the SDK <i><b>(modify paths to match your install locations)</b></i>
</p>
<ul><li>"C:\Program Files\Microsoft SDKs\Windows\v7.1\Bin\setenv.cmd" /release /x64</li></ul>
<p>Set the Visual C++ install directory environment variable to what Net-SNMP expects
</p>
<ul><li>SET VCINSTALLDIR=C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\</li></ul>
<p>Append the following environment variables to include OpenSSL headers and libraries
</p>
<ul><li>SET INCLUDE=%INCLUDE%;C:\OpenSSL\include</li>
<li>SET LIB=%LIB%;C:\OpenSSL\lib\VC\static</li></ul>
<p>Run the build script
</p>
<ul><li>c:\projects\net-snmp-5.7.2.1\win32\build.bat</li></ul>
<p>Change the following options to "enable" the corresponding features
</p>
<ul><li>1 OpenSSL support <i><b>enabled</b></i></li>
<li>2 Platform SDK support <i><b>enabled</b></i></li>
<li>5 Perl modules <i><b>enabled</b></i></li>
<li>6 Install perl modules <i><b>enabled</b></i></li>
<li>9 IPv6 transports <i><b>enabled</b></i></li>
<li>10 winExtDLL agent <i><b>enabled</b></i></li>
<li>11 Link type <i><b>static</b></i></li></ul>
<p>Press 'F', followed by Enter to finish and start building.
</p><p><b>Common Issues</b>
</p>
<ul><li>The build process fails while running Perl module tests.  Restart Windows after installing ActivePerl</li></ul>

<!-- 
NewPP limit report
Cached time: 20240514175644
Cache expiry: 0
Dynamic content: true
CPU time usage: 0.003 seconds
Real time usage: 0.004 seconds
Preprocessor visited node count: 1/1000000
Preprocessor generated node count: 4/1000000
Postâ€expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 1/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="indexbe25.html?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&amp;oldid=5849">http://www.net-snmp.org/wiki/index.php?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&amp;oldid=5849</a>"</div>
					<div id='catlinks' class='catlinks catlinks-allhidden'></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php/Using_the_command_line_and_nmake_(VC%2b%2b_2010_Express).html" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="index.php/Talk_Using_the_command_line_and_nmake_(VC%2b%2b_2010_Express).html?title=Talk:Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="index9cf0.html?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="index1442.html?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="indexceb6.html?title=Special:UserLogin&amp;returnto=Using+the+command+line+and+nmake+%28VC%2B%2B+2010+Express%29&amp;returntoquery=printable%3Dyes&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="indexf4c8.html?title=Special:UserLogin&amp;returnto=Using+the+command+line+and+nmake+%28VC%2B%2B+2010+Express%29&amp;returntoquery=printable%3Dyes" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.php/Main_Page.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-project" role="navigation">
		<h3>project</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Web-Site"><a href="../index.html" rel="nofollow">Web Site</a></li>
											<li id="n-Wiki"><a href="index.php/Main_Page.html">Wiki</a></li>
											<li id="n-Download"><a href="../download.html" rel="nofollow">download</a></li>
											<li id="n-Mailing-Lists"><a href="../support/mailinglists.html" rel="nofollow">Mailing Lists</a></li>
											<li id="n-Bug-Reports"><a href="../support/bugreports.html" rel="nofollow">Bug Reports</a></li>
											<li id="n-Patches"><a href="../support/patches.html" rel="nofollow">Patches</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-documentation" role="navigation">
		<h3>documentation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Tutorials"><a href="index.php/Tutorials.html">Tutorials</a></li>
											<li id="n-FAQ"><a href="index.php/FAQ.html">FAQ</a></li>
											<li id="n-Good-Answers"><a href="index.php/Category_GoodAnswer.html">Good Answers</a></li>
											<li id="n-Manual-Pages"><a href="../man/index.html" rel="nofollow">Manual Pages</a></li>
											<li id="n-Tools"><a href="index.php/Category_Tools.html">Tools</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-wiki" role="navigation">
		<h3>wiki</h3>
		<div class='pBody'>
							<ul>
											<li id="n-recentchanges"><a href="index.php/Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="index.php/Notes20111219.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://www.net-snmp.org/wiki/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Net-SNMP Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="index.php/Special_WhatLinksHere/Using_the_command_line_and_nmake_(VC%2b%2b_2010_Express).html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="index.php/Special_RecentChangesLinked/Using_the_command_line_and_nmake_(VC%2b%2b_2010_Express).html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="index.php/Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-permalink"><a href="indexbe25.html?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&amp;oldid=5849" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="index4918.html?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&amp;action=info" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified on 11 November 2014, at 14:29.</li>
									<li id="privacy"><a href="index.php/Net-SNMP_Wiki_Privacy_policy.html" title="Net-SNMP Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="index.php/Net-SNMP_Wiki_About.html" title="Net-SNMP Wiki:About">About Net-SNMP Wiki</a></li>
									<li id="disclaimer"><a href="index.php/Net-SNMP_Wiki_General_disclaimer.html" title="Net-SNMP Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"]);
} );</script><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":126});
} );</script></body>
<!-- Mirrored from www.net-snmp.org/wiki/index.php?title=Using_the_command_line_and_nmake_(VC%2B%2B_2010_Express)&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 18:28:23 GMT -->
</html>
