

<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from www.net-snmp.org/wiki/index.php?title=Vacm&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 18:23:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>View source for Vacm - Net-SNMP Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Vacm","wgTitle":"Vacm","wgCurRevisionId":5863,"wgRevisionId":0,"wgArticleId":1701,"wgIsArticle":!1,"wgIsRedirect":!1,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":!0,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Vacm","wgRelevantArticleId":1701,"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits"]);
} );</script>
<link rel="stylesheet" href="load34a1.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook" />
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="load3a95.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.26.3" />
<meta name="robots" content="noindex,nofollow" />
<link rel="shortcut icon" href="http://www.net-snmp.org/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://www.net-snmp.org/wiki/opensearch_desc.php" title="Net-SNMP Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://www.net-snmp.org/wiki/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Net-SNMP Wiki Atom feed" href="http://www.net-snmp.org/wiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Vacm skin-monobook action-edit">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">View source for Vacm</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Net-SNMP Wiki</div>
					<div id="contentSub">‚Üê <a href="http://www.net-snmp.org/wiki/index.php/Vacm" title="Vacm">Vacm</a></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text"><p>You do not have permission to edit this page, for the following reason:
</p>
<div class="permissions-errors">
<p>The action you have requested is limited to users in the group: <a href="http://www.net-snmp.org/wiki/index.php?title=Net-SNMP_Wiki:Users&amp;action=edit&amp;redlink=1" class="new" title="Net-SNMP Wiki:Users (page does not exist)">Users</a>.
</p>
</div>
<hr />
<p>You can view and copy the source of this page.
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" lang="en" dir="ltr" name="wpTextbox1">The View Access Control Model is one of the more complex configuration options that Net-SNMP offers.

==The Basics==
===Check the man page===
The [http://www.net-snmp.org/docs/man/snmpd.conf.html#lbAF Access Control] section of the [http://www.net-snmp.org/docs/man/snmpd.conf.html snmp.conf] manual page talks about VACM setup, and has the most current information. Check there first.

===A Visual Aid===
A user-contributed image and text-representation of the relationships can be found on the [http://www.net-snmp.org/tutorial/tutorial-5/demon/vacm/ VACM tutorial] page.

We also provide this handy diagram showing how include/exclude functions overlay each other within a "fake" mib tree:

[[image:vacm_tree.jpeg|none|thumb|caption|500px|Including and Excluding MIB Tree Elements]]

==Living in Denial==
In response to the "arrgh, this is too complex for my poor little brain!" types of messages we get about configuring access control, you can avoid it if your needs are simple. So, if you just want to give a user read or write access to the entire MIB tree, you can use the &lt;code>ro&lt;/code> and &lt;code>rw&lt;/code> configuration options, which specify read-only (ro) or read-write (rw) access.

===SNMPv1 and SNMPv2 rocommunity/rwcommunity===
These directives allow access for community based requests,
optionally restricted to a particular range of source IP addresses,
and/or a specific OID. See the [http://www.net-snmp.org/docs/man/snmpd.conf.html#lbAH snmpd.conf] man page for detail, but the general form is:

       rocommunity COMMUNITY [SOURCE [OID]]
       rwcommunity COMMUNITY [SOURCE [OID]]
       rocommunity6 COMMUNITY [SOURCE [OID]]
       rwcommunity6 COMMUNITY [SOURCE [OID]]

With version 5.3 and above, this directive can also restrict access
to a named view, using the syntax

       rocommunity COMMUNITY SOURCE -V VIEW
       rwcommunity COMMUNITY SOURCE -V VIEW
       rocommunity6 COMMUNITY SOURCE -V VIEW
       rwcommunity6 COMMUNITY SOURCE -V VIEW

===SNMPv3 rouser/rwuser===
These directives allow access for SNMPv3 users, optionally requiring a certain access level and restricting the user to a specific OID. See the [http://www.net-snmp.org/docs/man/snmpd.conf.html#lbAH snmpd.conf] man page for detail, but the general form is:

 rouser USER [noauth|auth|priv [OID]]
 rwuser USER [noauth|auth|priv [OID]]

With version 5.3 and above, this directive can also restrict access to a named view, using the syntax

 rouser USER noauth|auth|priv -V NAME
 rwuser USER noauth|auth|priv -V NAME

==Special Cases and Examples==
Here are some examples of more complex configurations, include supporting different views for a SNMPv3 user based on their security level.

===VACM Views, or How to restrict access to particular branches in the tree===

 ####
 # First, map the community name (COMMUNITY) into a security name
 # (local and mynetwork, depending on where the request is coming
 # from):
 
 #       sec.name  source          community
 com2sec local     localhost       secret42&lt;font color=red>
 com2sec custom_sec 192.168.1.0/24  public&lt;/font>
 
 ####
 # Second, map the security names into group names:
 
 #               sec.model  sec.name
 &lt;font color=red>
 group custom_grp v1         custom_sec
 group custom_grp v2c        custom_sec
 
 group incremental usm       myuser      # SNMPv3 username == sec.name
 &lt;/font>
 ####
 # Third, create a view for us to let the groups have rights to:
 
 #           incl/excl subtree                              mask
 view all    included  .1
 &lt;font color=red>
 view custom_v excluded  .1
 view custom_v included  sysUpTime.0
 view custom_v included  interfaces.ifTable
 
 view mini_view excluded .1 80
 view mini_view included  sysUpTime.0
 
 view if_view excluded .1 80
 view if_view included  sysUpTime.0
 view if_view included  ifTable
 &lt;/font>
 
 ####
 # Finally, grant the groups access to their views:
 
 #                context sec.model sec.level match  read     write  notif
 access MyRWGroup ""      any       noauth    exact  all      all    none&lt;font color=red>
 access custom_grp ""     any       noauth    exact  cust1_v  none   none
 
 access incremental ""    usm       noauth    exact  mini_view none  none
 access incremental ""    usm       auth      exact  if_view   none  none
 access incremental ""    usm       priv      exact  all_view  none  none
 &lt;/font>

===VACM Masks, or How to restrict access to a particular index (row) in a Table===
Using the &lt;code>view&lt;/code> directive in &lt;code>snmpd.conf&lt;/code>, one can limit users to a single row in a table. To do this, the optional &lt;code>mask&lt;/code> parameter is specified. Here is an excerpt from the man page:

       view NAME TYPE SUBTREE [MASK]
              The defines the named view. TYPE is either included
              or  excluded.   MASK is a list of hex octets, sepa-
              rated by '.' or ':'.  The MASK defaults to "ff"  if
              not specified.
 
              The  reason  for the mask is, that it allows you to
              control access to one row in a table,  in  a  rela-
              tively  simple  way.  As  an example, as an ISP you
              might consider giving each customer access  to  his
              or her own interface:
 
              view cust1 included interfaces.ifTable.ifEntry.ifIndex.1 ff.a0
              view cust2 included interfaces.ifTable.ifEntry.ifIndex.2 ff.a0
 
              (interfaces.ifTable.ifEntry.ifIndex.1 == .1.3.6.1.2.1.2.2.1.1.1,
              ff.a0 == 11111111.10100000. which nicely covers up and including
              the row index, but lets the user vary the field of the row)

Note: The mask seperator character can be "." or ":".

So, to be a little more visual about it:
 .1.3.6.1.2.1.2.2.1.1.1 == interfaces.ifTable.ifEntry.ifIndex.1 
  1 1 1 1 1 1 1 1 1 0 1 (00000) == (ff.a0)
                ^ ^ ^ ^
                | | | |-- the index
                | | |---- the column
                | |------ ifEntry
                |-------- ifTable

So each bit in the mask indicates if the corresponding OID must match or not. In the above example, all parts of the OID except the colum must match. So this view allows access to any column of the first row in the ifTable. So, paired with an &lt;code>exclude&lt;/code> row for the ifTable, only row 1 would be accessible to the user.

Now, to bring it all together with the other access control directives. Assuming 2 customers, and each is only connected to a specific interface (eg customer 1 is connected to eth0 and customer 2 is connected to eth1):

 ####
 # First, map the community name (COMMUNITY) into a security name
 # (local and mynetwork, depending on where the request is coming
 # from):
 
 #       sec.name  source          community
 com2sec local     localhost       secret42
 com2sec &lt;font color=red>cust1_sec&lt;/font> 192.168.1.0/24  public
 com2sec &lt;font color=red>cust2_sec&lt;/font> 192.168.2.0/24  public
 
 ####
 # Second, map the security names into group names:
 
 #               sec.model  sec.name
 group MyRWGroup v1         local
 group MyRWGroup v2c        local
 &lt;font color=red>
 group cust1_grp v1         cust1_sec
 group cust1_grp v2c        cust1_sec
 
 group cust2_grp v1         cust2_sec
 group cust2_grp v2c        cust2_sec
 &lt;/font>
 ####
 # Third, create a view for us to let the groups have rights to:
 
 #           incl/excl subtree                              mask
 view all    included  .1
 &lt;font color=red>
 view cust1_v excluded  .1
 view cust1_v included  sysUpTime.0
 view cust1_v included  interfaces.ifTable.ifEntry.ifIndex.1 ff.a0
 
 view cust2_v excluded  .1
 view cust2_v included  sysUpTime.0
 view cust2_v included  interfaces.ifTable.ifEntry.ifIndex.2 ff.a0
 &lt;/font>
 ####
 # Finally, grant the groups access to their views:
 
 #                context sec.model sec.level match  read     write  notif
 access MyRWGroup ""      any       noauth    exact  all      all    none&lt;font color=red>
 access cust1_grp ""      any       noauth    exact  cust1_v  none   none
 access cust2_grp ""      any       noauth    exact  cust2_v  none   none
 &lt;/font>

It is important to note that this works because the customers are on different networks. If all the customers are on the same network, then it is important to note that sniffing network traffic could expose one customer's "community string" to another customer, allowing the second customer to view the first customers interface statistics via SNMP. In this case, you would want to use the encryption capabilities offered by SNMPv3 usm users, instead of SNMPv1 and SNMPv2 community strings.

===Using Contexts===
SNMPv3 'contexts' can be emulated for SNMPv1 and SNMPv2 communities, as explained on [[Snmpd_proxy|this page for configuring multiple proxies]].
</textarea><div class="templatesUsed"></div><p id="mw-returnto">Return to <a href="http://www.net-snmp.org/wiki/index.php/Vacm" title="Vacm">Vacm</a>.</p>
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.net-snmp.org/wiki/index.php/Vacm">http://www.net-snmp.org/wiki/index.php/Vacm</a>"</div>
					<div id='catlinks' class='catlinks catlinks-allhidden'></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="http://www.net-snmp.org/wiki/index.php/Vacm" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://www.net-snmp.org/wiki/index.php?title=Talk:Vacm&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource" class="selected"><a href="http://www.net-snmp.org/wiki/index.php?title=Vacm&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="http://www.net-snmp.org/wiki/index.php?title=Vacm&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="http://www.net-snmp.org/wiki/index.php?title=Special:UserLogin&amp;returnto=Vacm&amp;returntoquery=action%3Dedit&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="http://www.net-snmp.org/wiki/index.php?title=Special:UserLogin&amp;returnto=Vacm&amp;returntoquery=action%3Dedit" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="http://www.net-snmp.org/wiki/index.php/Main_Page" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-project" role="navigation">
		<h3>project</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Web-Site"><a href="http://www.net-snmp.org/" rel="nofollow">Web Site</a></li>
											<li id="n-Wiki"><a href="http://www.net-snmp.org/wiki/index.php/Main_Page">Wiki</a></li>
											<li id="n-Download"><a href="http://www.net-snmp.org/download.html" rel="nofollow">download</a></li>
											<li id="n-Mailing-Lists"><a href="http://www.net-snmp.org/support/mailinglists.html" rel="nofollow">Mailing Lists</a></li>
											<li id="n-Bug-Reports"><a href="http://www.net-snmp.org/support/bugreports.html" rel="nofollow">Bug Reports</a></li>
											<li id="n-Patches"><a href="http://www.net-snmp.org/support/patches.html" rel="nofollow">Patches</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-documentation" role="navigation">
		<h3>documentation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Tutorials"><a href="http://www.net-snmp.org/wiki/index.php/Tutorials">Tutorials</a></li>
											<li id="n-FAQ"><a href="http://www.net-snmp.org/wiki/index.php/FAQ">FAQ</a></li>
											<li id="n-Good-Answers"><a href="http://www.net-snmp.org/wiki/index.php/Category:GoodAnswer">Good Answers</a></li>
											<li id="n-Manual-Pages"><a href="http://www.net-snmp.org/man" rel="nofollow">Manual Pages</a></li>
											<li id="n-Tools"><a href="http://www.net-snmp.org/wiki/index.php/Category:Tools">Tools</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-wiki" role="navigation">
		<h3>wiki</h3>
		<div class='pBody'>
							<ul>
											<li id="n-recentchanges"><a href="http://www.net-snmp.org/wiki/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="http://www.net-snmp.org/wiki/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://www.net-snmp.org/wiki/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Net-SNMP Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="http://www.net-snmp.org/wiki/index.php/Special:WhatLinksHere/Vacm" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="http://www.net-snmp.org/wiki/index.php/Special:RecentChangesLinked/Vacm" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="http://www.net-snmp.org/wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-info"><a href="http://www.net-snmp.org/wiki/index.php?title=Vacm&amp;action=info" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="http://www.net-snmp.org/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
							</div>
					<ul id="f-list">
									<li id="privacy"><a href="http://www.net-snmp.org/wiki/index.php/Net-SNMP_Wiki:Privacy_policy" title="Net-SNMP Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="http://www.net-snmp.org/wiki/index.php/Net-SNMP_Wiki:About" title="Net-SNMP Wiki:About">About Net-SNMP Wiki</a></li>
									<li id="disclaimer"><a href="http://www.net-snmp.org/wiki/index.php/Net-SNMP_Wiki:General_disclaimer" title="Net-SNMP Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.action.edit.collapsibleFooter","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"]);
} );</script><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":124});
} );</script></body>
<!-- Mirrored from www.net-snmp.org/wiki/index.php?title=Vacm&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 18:23:21 GMT -->
</html>
