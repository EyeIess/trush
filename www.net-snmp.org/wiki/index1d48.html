

<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from www.net-snmp.org/wiki/index.php?title=TUT:MRTG&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 18:23:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>View source for TUT:MRTG - Net-SNMP Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"TUT:MRTG","wgTitle":"TUT:MRTG","wgCurRevisionId":4204,"wgRevisionId":0,"wgArticleId":1852,"wgIsArticle":!1,"wgIsRedirect":!1,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":!0,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"TUT:MRTG","wgRelevantArticleId":1852,"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits"]);
} );</script>
<link rel="stylesheet" href="load34a1.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook" />
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="load3a95.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.26.3" />
<meta name="robots" content="noindex,nofollow" />
<link rel="shortcut icon" href="http://www.net-snmp.org/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://www.net-snmp.org/wiki/opensearch_desc.php" title="Net-SNMP Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://www.net-snmp.org/wiki/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Net-SNMP Wiki Atom feed" href="http://www.net-snmp.org/wiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-TUT_MRTG skin-monobook action-edit">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">View source for TUT:MRTG</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Net-SNMP Wiki</div>
					<div id="contentSub">‚Üê <a href="http://www.net-snmp.org/wiki/index.php/TUT:MRTG" title="TUT:MRTG">TUT:MRTG</a></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text"><p>You do not have permission to edit this page, for the following reason:
</p>
<div class="permissions-errors">
<p>The action you have requested is limited to users in the group: <a href="http://www.net-snmp.org/wiki/index.php?title=Net-SNMP_Wiki:Users&amp;action=edit&amp;redlink=1" class="new" title="Net-SNMP Wiki:Users (page does not exist)">Users</a>.
</p>
</div>
<hr />
<p>You can view and copy the source of this page.
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" lang="en" dir="ltr" name="wpTextbox1">Broadly speaking, there are two basic techniques for monitoring a system using SNMP.
Either the agent can be configured to watch for certain values or events, and report
to a management station when something significant happens.
Alternatively, some external application can be set up that will poll the agent
regularly, and collect the information of interest.

The [[TUT:DisMan Monitoring|DisMan Monitoring]] page describes the first approach -
this tutorial will concentrate on the second, using the [http://www.mrtg.org Multi Router Traffic Grapher]
tool.

Note that this does not attempt to be a complete tutorial on the use of MRTG,
or even cover monitoring network traffic.  Such topics are comprehensively
covered on the MRTG site already.  This page is specifically concerned with
discussing other values that can be monitored using MRTG.

== Monitoring CPU load ==

There are several ways to try to monitor CPU usage, because the system maintains several CPU counters: Idle, System, User, Nice. As MRTG does not allow you to graph more than two values at a time, it is possible to select any two values and graph against each other.  It is also possible to compute a combined value.

=== User vs Idle CPU usage ===

The MRTG configuration would look something like

    LoadMIBs: /usr/local/share/snmp/mibs/UCD-SNMP-MIB.txt
    
    Target[kontor.cpu]:ssCpuRawUser.0&amp;ssCpuRawIdle.0:public@10.10.11.2
    RouterUptime[kontor.cpu]: public@10.10.11.2
    MaxBytes[kontor.cpu]: 100
    Title[kontor.cpu]: CPU LOAD
    PageTop[kontor.cpu]: &amp;lt;H1&amp;gt;User CPU Load %&amp;lt;/H1&amp;gt;
    Unscaled[kontor.cpu]: ymwd
    ShortLegend[kontor.cpu]: %
    YLegend[kontor.cpu]: CPU Utilization
    Legend1[kontor.cpu]: User CPU in % (Load)
    Legend2[kontor.cpu]: Idle CPU in % (Load)
    Legend3[kontor.cpu]:
    Legend4[kontor.cpu]:
    LegendI[kontor.cpu]:  User
    LegendO[kontor.cpu]:  Idle
    Options[kontor.cpu]: growright,nopercent

=== User vs System CPU usage ===

The MRTG configuration would look something like

    LoadMIBs: /usr/local/share/snmp/mibs/UCD-SNMP-MIB.txt

    Target[kontor.usrsys]:ssCpuRawUser.0&amp;ssCpuRawSystem.0:public@10.10.11.2
    RouterUptime[kontor.usrsys]: public@10.10.11.2
    MaxBytes[kontor.usrsys]: 100
    Title[kontor.usrsys]: CPU LOAD
    PageTop[kontor.usrsys]: &amp;lt;H1&amp;gt;CPU (user and system) Load %&amp;lt;/H1&amp;gt;
    Unscaled[kontor.usrsys]: ymwd
    ShortLegend[kontor.usrsys]: %
    YLegend[kontor.usrsys]: CPU Utilization
    Legend1[kontor.usrsys]: User CPU in % (Load)
    Legend2[kontor.usrsys]: System CPU in % (Load)
    Legend3[kontor.usrsys]:
    Legend4[kontor.usrsys]:
    LegendI[kontor.usrsys]:  User
    LegendO[kontor.usrsys]:  System
    Options[kontor.usrsys]: growright,nopercent

=== Active CPU usage ===

This example sums User, System and Nice and plots it as a single value.

The corresponding MRTG configuration is

    LoadMIBs: /usr/local/share/snmp/mibs/UCD-SNMP-MIB.txt

    Target[kontor.cpusum]:ssCpuRawUser.0&amp;ssCpuRawUser.0:public@10.10.11.2 + \
                          ssCpuRawSystem.0&amp;ssCpuRawSystem.0:public@10.10.11.2 + \
                          ssCpuRawNice.0&amp;ssCpuRawNice.0:public@10.10.11.2
    RouterUptime[kontor.cpusum]: public@10.10.11.2
    MaxBytes[kontor.cpusum]: 100
    Title[kontor.cpusum]: CPU LOAD
    PageTop[kontor.cpusum]: &amp;lt;H1&amp;gt;Active CPU Load %&amp;lt;/H1&amp;gt;
    Unscaled[kontor.cpusum]: ymwd
    ShortLegend[kontor.cpusum]: %
    YLegend[kontor.cpusum]: CPU Utilization
    Legend1[kontor.cpusum]: Active CPU in % (Load)
    Legend2[kontor.cpusum]:
    Legend3[kontor.cpusum]:
    Legend4[kontor.cpusum]:
    LegendI[kontor.cpusum]:  Active
    LegendO[kontor.cpusum]:
    Options[kontor.cpusum]: growright,nopercent

== Monitoring Disk space ==

There are two tables that can be used when monitoring disk space, UCD-SNMP-MIB:dskTable and HOST-RESOURCES-MIB:hrStorageTable. There are two noticeable differences bwtween these tables: UCD-SNMP-MIB:dskTable requires a configuration directive in snmpd.conf, but it also gives a direct measure of the percentage of free space

On the system I used for these examples, I have the following disks: 

    $ df
    Filesystem            Size  Used Avail Use% Mounted on
    /dev/hda6             289M   56M  218M  21% /
    /dev/hda1             7.3G  3.2G  4.1G  44% /mnt/windows
    /dev/hda7             1.7G  1.2G  429M  74% /usr
    /dev/hdc1              19G  6.7G   11G  37% /space
    

and I have put the following lines into snmpd.conf:

    disk	/	100000
    disk	/usr	100000
    disk	/space	100000

=== Monitoring dskTable ===

This plots the usage of the root and /usr partitions in one graph

    LoadMIBs: /usr/local/share/snmp/mibs/UCD-SNMP-MIB.txt

    Target[kontor.root]:dskPercent.1&amp;dskPercent.2:public@10.10.11.2
    RouterUptime[kontor.root]: public@10.10.11.2
    MaxBytes[kontor.root]: 100
    Title[kontor.root]: DISK USAGE
    PageTop[kontor.root]: &amp;lt;H1&amp;gt;DISK / and /usr Usage %&amp;lt;/H1&amp;gt;
    Unscaled[kontor.root]: ymwd
    ShortLegend[kontor.root]: %
    YLegend[kontor.root]: DISK Utilization
    Legend1[kontor.root]: Root disk
    Legend2[kontor.root]: /usr disk
    Legend3[kontor.root]:
    Legend4[kontor.root]:
    LegendI[kontor.root]:  Root disk
    LegendO[kontor.root]:  /usr disk
    Options[kontor.root]: growright,gauge,nopercent

=== Monitoring hrStorageTable ===

This plots the partition size as one value, and the used space as another.

Note: the values returned here are in units of hrStorageUnits, which, dependent on the file system type, may or may not be 1K.

    LoadMIBs: /usr/local/share/snmp/mibs/HOST-RESOURCES-MIB.txt

    Target[kontor.hrroot]:hrStorageSize.1&amp;hrStorageUsed.1:public@10.10.11.2
    RouterUptime[kontor.hrroot]: public@10.10.11.2
    MaxBytes[kontor.hrroot]: 300000
    Title[kontor.hrroot]: DISK / USAGE
    PageTop[kontor.hrroot]: &amp;lt;H1&amp;gt;DISK / Usage&amp;lt;/H1&amp;gt;
    ShortLegend[kontor.hrroot]: B
    kMG[kontor.hrroot]: k,M,G,T,P
    kilo[kontor.hrroot]: 1024
    YLegend[kontor.hrroot]: DISK / Utilization
    Legend1[kontor.hrroot]: Root disk size
    Legend2[kontor.hrroot]: Root disk usage
    Legend3[kontor.hrroot]:
    Legend4[kontor.hrroot]:
    LegendI[kontor.hrroot]:  Root disk size
    LegendO[kontor.hrroot]:  Root disk usage
    Options[kontor.hrroot]: growright,gauge,nopercent
    
== Other Monitoring Examples ==

Two further examples that have been offered:

=== Monitoring TCP connections ===

    Target[tcpopen]: 
    .1.3.6.1.2.1.6.9.0&amp;.1.3.6.1.2.1.6.9.0:public@localhost 
    Options[tcpopen]: nopercent,growright,gauge,noinfo 
    Title[tcpopen]: Open TCP connections 
    PageTop[tcpopen]: Open TCP connections
    MaxBytes[tcpopen]: 1000000 
    YLegend[tcpopen]: # conns 
    ShortLegend[tcpopen]: connections 
    LegendI[tcpopen]:  Connections: 
    LegendO[tcpopen]: 
    Legend1[tcpopen]: Open TCP connections 

=== Monitoring Free Memory ===

    Target[freemem]: 
    .1.3.6.1.4.1.2021.4.11.0&amp;.1.3.6.1.4.1.2021.4.11.0:public@localhost 
    Options[freemem]: nopercent,growright,gauge,noinfo 
    Title[freemem]: Free Memory 
    PageTop[freemem]: Free Memory
    MaxBytes[freemem]: 1000000 
    kMG[freemem]: k,M,G,T,P,X 
    YLegend[freemem]: bytes 
    ShortLegend[freemem]: bytes 
    LegendI[freemem]:  Free Memory: 
    LegendO[freemem]: 
    Legend1[freemem]: Free memory, not including swap, in bytes

&lt;hr>

{{TUT:LIST}}
</textarea><div class="templatesUsed"><div class="mw-templatesUsedExplanation"><p>Template used on this page:
</p></div><ul>
<li><a href="http://www.net-snmp.org/wiki/index.php/Template:TUT:LIST" title="Template:TUT:LIST">Template:TUT:LIST</a> (<a href="http://www.net-snmp.org/wiki/index.php?title=Template:TUT:LIST&amp;action=edit" title="Template:TUT:LIST">view source</a>) </li></ul></div><p id="mw-returnto">Return to <a href="http://www.net-snmp.org/wiki/index.php/TUT:MRTG" title="TUT:MRTG">TUT:MRTG</a>.</p>
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.net-snmp.org/wiki/index.php/TUT:MRTG">http://www.net-snmp.org/wiki/index.php/TUT:MRTG</a>"</div>
					<div id='catlinks' class='catlinks catlinks-allhidden'></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="http://www.net-snmp.org/wiki/index.php/TUT:MRTG" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://www.net-snmp.org/wiki/index.php?title=Talk:TUT:MRTG&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource" class="selected"><a href="http://www.net-snmp.org/wiki/index.php?title=TUT:MRTG&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="http://www.net-snmp.org/wiki/index.php?title=TUT:MRTG&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="http://www.net-snmp.org/wiki/index.php?title=Special:UserLogin&amp;returnto=TUT%3AMRTG&amp;returntoquery=action%3Dedit&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="http://www.net-snmp.org/wiki/index.php?title=Special:UserLogin&amp;returnto=TUT%3AMRTG&amp;returntoquery=action%3Dedit" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="http://www.net-snmp.org/wiki/index.php/Main_Page" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-project" role="navigation">
		<h3>project</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Web-Site"><a href="http://www.net-snmp.org/" rel="nofollow">Web Site</a></li>
											<li id="n-Wiki"><a href="http://www.net-snmp.org/wiki/index.php/Main_Page">Wiki</a></li>
											<li id="n-Download"><a href="http://www.net-snmp.org/download.html" rel="nofollow">download</a></li>
											<li id="n-Mailing-Lists"><a href="http://www.net-snmp.org/support/mailinglists.html" rel="nofollow">Mailing Lists</a></li>
											<li id="n-Bug-Reports"><a href="http://www.net-snmp.org/support/bugreports.html" rel="nofollow">Bug Reports</a></li>
											<li id="n-Patches"><a href="http://www.net-snmp.org/support/patches.html" rel="nofollow">Patches</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-documentation" role="navigation">
		<h3>documentation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Tutorials"><a href="http://www.net-snmp.org/wiki/index.php/Tutorials">Tutorials</a></li>
											<li id="n-FAQ"><a href="http://www.net-snmp.org/wiki/index.php/FAQ">FAQ</a></li>
											<li id="n-Good-Answers"><a href="http://www.net-snmp.org/wiki/index.php/Category:GoodAnswer">Good Answers</a></li>
											<li id="n-Manual-Pages"><a href="http://www.net-snmp.org/man" rel="nofollow">Manual Pages</a></li>
											<li id="n-Tools"><a href="http://www.net-snmp.org/wiki/index.php/Category:Tools">Tools</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-wiki" role="navigation">
		<h3>wiki</h3>
		<div class='pBody'>
							<ul>
											<li id="n-recentchanges"><a href="http://www.net-snmp.org/wiki/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="http://www.net-snmp.org/wiki/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://www.net-snmp.org/wiki/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Net-SNMP Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="http://www.net-snmp.org/wiki/index.php/Special:WhatLinksHere/TUT:MRTG" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="http://www.net-snmp.org/wiki/index.php/Special:RecentChangesLinked/TUT:MRTG" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="http://www.net-snmp.org/wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-info"><a href="http://www.net-snmp.org/wiki/index.php?title=TUT:MRTG&amp;action=info" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="http://www.net-snmp.org/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
							</div>
					<ul id="f-list">
									<li id="privacy"><a href="http://www.net-snmp.org/wiki/index.php/Net-SNMP_Wiki:Privacy_policy" title="Net-SNMP Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="http://www.net-snmp.org/wiki/index.php/Net-SNMP_Wiki:About" title="Net-SNMP Wiki:About">About Net-SNMP Wiki</a></li>
									<li id="disclaimer"><a href="http://www.net-snmp.org/wiki/index.php/Net-SNMP_Wiki:General_disclaimer" title="Net-SNMP Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.action.edit.collapsibleFooter","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"]);
} );</script><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":123});
} );</script></body>
<!-- Mirrored from www.net-snmp.org/wiki/index.php?title=TUT:MRTG&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 May 2024 18:23:32 GMT -->
</html>
